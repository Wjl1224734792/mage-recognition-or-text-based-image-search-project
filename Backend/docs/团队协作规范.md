# 团队协作规范

## ⚙️ 代码格式化规范 (Prettier)

### 1. 统一代码风格配置
```json
{
  "semi": true,
  "trailingComma": "es5",
  "singleQuote": true,
  "printWidth": 80,
  "tabWidth": 2,
  "useTabs": false,
  "endOfLine": "lf",
  "arrowParens": "avoid"
}
```

### 2. 集成配置
- **与ESLint协作**：通过`eslint-config-prettier`避免规则冲突
- **Git Hooks集成**：通过husky在pre-commit阶段自动格式化
- **编辑器支持**：VS Code保存时自动格式化

## 🔍 代码质量规范 (ESLint)

### 1. 代码检查规则体系
```javascript
export default {
  env: {
    node: true,
    es2024: true
  },
  extends: [
    'eslint:recommended',
    '@typescript-eslint/recommended',
    'prettier'
  ],
  parser: '@typescript-eslint/parser',
  parserOptions: {
    ecmaVersion: 'latest',
    sourceType: 'module'
  },
  rules: {
    '@typescript-eslint/no-explicit-any': 'warn',
    'no-console': process.env.NODE_ENV === 'production' ? 'warn' : 'off',
    'no-debugger': process.env.NODE_ENV === 'production' ? 'warn' : 'off',
    'no-unused-vars': 'error',
    'prefer-const': 'error'
  }
}
```

### 2. 自定义规则策略
- **严格类型检查**：TypeScript严格模式启用
- **Node.js最佳实践**：错误处理、内存管理规范
- **导入优化**：自动排序和未使用导入清理
- **渐进式采用**：通过注释临时禁用规则`// eslint-disable-line`

## 🌿 分支管理规范

### 1. 分支策略架构
```
main                    # 主干分支 - 生产环境代码（受保护）
├── develop             # 开发分支 - 功能集成环境（受保护）
│   ├── feature/*      # 功能分支 - 新功能开发
│   ├── hotfix/*       # 紧急修复分支 - 生产问题修复
│   └── experiment/*   # 实验性分支 - 技术探索
└── release/*          # 发布分支 - 版本发布准备
```

### 2. 分支命名规则
| 分支类型 | 命名格式                    | 示例                                   | 说明         |
| -------- | --------------------------- | -------------------------------------- | ------------ |
| 功能分支 | `feature/YYYYMMDD_功能描述` | `feature/20231201_user_authentication` | 新功能开发   |
| 修复分支 | `hotfix/YYYYMMDD_问题描述`  | `hotfix/20231202_login_bug`            | 紧急问题修复 |
| 发布分支 | `release/版本号`            | `release/v1.2.0`                       | 版本发布准备 |
| 文档分支 | `docs/文档主题`             | `docs/api_reference`                   | 文档更新     |

### 3. 合并流程规范
1. **分支保护**：main、develop分支设置保护规则
2. **代码审查**：至少需要1名核心成员审查通过
3. **Rebase操作**：合并前必须rebase到目标分支最新代码
4. **CI/CD检查**：必须通过所有自动化测试和检查
5. **提交历史**：保持线性、清晰的提交历史

## 📝 提交信息规范 (Conventional Commits)

### 1. 提交信息标准格式
```
<类型>[可选 范围]: <描述>

[可选 正文]

[可选 脚注]
```

### 2. 提交类型规范
| 类型       | 描述     | 示例                                |
| ---------- | -------- | ----------------------------------- |
| `feat`     | 新功能   | `feat(auth): 添加用户登录功能`      |
| `fix`      | bug修复  | `fix(login): 修复登录接口500错误`   |
| `docs`     | 文档更新 | `docs(api): 更新用户API文档`        |
| `style`    | 代码样式 | `style: 调整代码格式`               |
| `refactor` | 代码重构 | `refactor(utils): 重构日期处理函数` |
| `test`     | 测试相关 | `test(user): 添加用户服务单元测试`  |
| `chore`    | 构建工具 | `chore(deps): 更新依赖包`           |
| `perf`     | 性能优化 | `perf(db): 优化数据库查询性能`      |
| `ci`       | CI配置   | `ci(github): 添加自动化测试流水线`  |

### 3. 协同开发提交规范检查
**commit-lint配置推荐**：

```javascript
// commitlint.config.js
export default {
  extends: ['@commitlint/config-conventional'],
  rules: {
    'type-enum': [
      2,
      'always',
      ['feat', 'fix', 'docs', 'style', 'refactor', 'test', 'chore', 'perf', 'ci']
    ],
    'subject-case': [2, 'never', ['sentence-case', 'start-case', 'pascal-case']]
  }
};
```

**Git Hooks集成**：

```json
{
  "husky": {
    "hooks": {
      "commit-msg": "commitlint -E HUSKY_GIT_PARAMS",
      "pre-commit": "lint-staged"
    }
  },
  "lint-staged": {
    "*.{js,ts}": ["eslint --fix", "prettier --write"],
    "*.{json,md}": ["prettier --write"]
  }
}
```